<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static',filename='css/styles.css')  }}">
</head>
<body>
    <header class="dashboard-header">
        <h1>Welcome to Dashboard, {{ username }}</h1>
        <a href="/logout"><button class="dashboard-btn-logout">Logout</button></a>
    </header>
    
    <div class="dashboard-container">
        <div class="dashboard-actions-top">
            <button class="dashboard-btn" onclick="window.location.href='/recommendByGenres'">Find Recommendations</button>
        </div>

        <table class="dashboard-table">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Author</th>
                    <th>Status</th>
                    <th>Start Date</th>
                    <th>Notes</th>
                    <th>Bookmark Page</th>
                    <th>Last Read On</th>
                    <th>Times read</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for book in books %}
                <tr>
                    <td>{{ book.title }}</td>
                    <td>{{ book.author }}</td>
                    <td>
                        <form action="/update_status/{{ book.id }}" method="POST" class="dashboard-status-form">
                            <select name="status" class="dashboard-status-dropdown" onchange="this.form.submit()">
                                <option value="reading" {% if book.status == 'reading' %}selected{% endif %}>Reading</option>
                                <option value="completed" {% if book.status == 'completed' %}selected{% endif %}>Completed</option>
                            </select>
                        </form>
                    </td>                    
                    <td>{{ book.start_date }}</td>
                    <td>
                        <form action="/update_notes/{{ book.id }}" method="POST" class="dashboard-notes-form">
                            <textarea name="notes" class="dashboard-notes-textarea" rows="2" 
                                      placeholder="Add notes..." onchange="this.form.submit()">{{ book.notes }}</textarea>
                        </form>
                    </td>
                    <td>{{ book.bookmark_page_no }}</td>
                    <td>
                        <form action="/update_last_read/{{ book.id }}" method="POST" class="dashboard-datetime-form">
                            <input 
                                type="datetime-local"   
                                name="last_read_datetime" 
                                class="dashboard-datetime-input" 
                                value="{{ book.last_read_datetime|datetimeformat }}" 
                                max="{{ current_datetime|datetimeformat }}"
                                onchange="this.form.submit()"
                            />
                        </form>
                    </td>
                    
                    <td>{{ book.times_read }}</td>
                    <td><a href="/delete/{{ book.id }}"><button class="dashboard-btn-delete">Del</button></a></td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="8" class="dashboard-no-books">No books added yet.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <br>
        <div class="dashboard-actions">
           <button class="dashboard-btn" onclick="window.location.href='/addBook'">Add a Book</button>
        </div>
    </div>
    <br><br><br>
    <footer class="dashboard-footer">
        <p>Â© 2024 Book Tracker App</p>
    </footer>
</body>
</html>
